mod ed25519;
mod secp256k1;

use crate::ed25519::verify_ecdh;

#[test]
fn test_curve25519_ecdh1() {
    let public_key_x: [u8; 32] = [
        47, 100, 59, 232, 254, 161, 240, 156, 233, 143, 42, 9, 39, 195, 198, 125, 200, 165, 13, 27, 255, 19, 12, 104, 53, 29, 241, 107, 144, 145, 226, 81
    ];
    let public_key_y: [u8; 32] = [
        252, 153, 143, 11, 254, 159, 5, 44, 238, 235, 124, 218, 62, 41, 75, 15, 159, 133, 154, 122, 131, 25, 145, 7, 238, 39, 87, 115, 89, 198, 137, 98
    ];
    let secret_key: [u8; 32] = [
        41, 212, 229, 118, 36, 91, 173, 38, 163, 155, 226, 38, 20, 30, 214, 51, 96, 136, 44, 100, 245, 1, 151, 139, 2, 4, 135, 43, 145, 218, 56, 6
    ];
    let shared_key_x: [u8; 32] = [
        181, 132, 189, 133, 236, 8, 10, 118, 196, 221, 53, 53, 113, 152, 120, 122, 92, 0, 220, 211, 221, 219, 56, 31, 63, 45, 55, 221, 237, 244, 188, 46
    ];
    let shared_key_y: [u8; 32] = [
        22, 170, 97, 107, 76, 145, 161, 158, 79, 210, 202, 255, 165, 159, 226, 117, 234, 252, 243, 200, 151, 47, 31, 40, 147, 173, 58, 53, 157, 133, 160, 77
    ];
    assert(
        verify_ecdh(
            secret_key,
            (shared_key_x, shared_key_y),
            (public_key_x, public_key_y)
        )
    );
}

#[test]
fn test_curve25519_ecdh2() {
    let public_key_x: [u8; 32] = [
        250, 252, 157, 187, 212, 177, 149, 255, 117, 2, 41, 75, 237, 237, 62, 155, 136, 185, 138, 205, 233, 206, 91, 181, 86, 212, 40, 101, 21, 162, 129, 96
    ];
    let public_key_y: [u8; 32] = [
        105, 233, 77, 189, 100, 191, 195, 190, 201, 48, 68, 60, 197, 20, 67, 129, 167, 232, 243, 2, 62, 7, 105, 207, 90, 75, 159, 213, 239, 69, 116, 111
    ];
    let secret_key: [u8; 32] = [
        21, 49, 109, 170, 194, 92, 80, 44, 139, 132, 17, 87, 22, 85, 67, 34, 167, 113, 232, 139, 52, 33, 64, 1, 151, 205, 182, 138, 31, 4, 38, 13
    ];
    let shared_key_x: [u8; 32] = [
        98, 48, 248, 130, 229, 224, 88, 25, 149, 88, 97, 117, 221, 222, 76, 94, 133, 194, 231, 56, 139, 250, 91, 248, 100, 17, 242, 251, 250, 52, 14, 78
    ];
    let shared_key_y: [u8; 32] = [
        193, 215, 255, 93, 148, 64, 81, 240, 245, 106, 69, 21, 193, 246, 220, 135, 73, 28, 50, 32, 49, 87, 245, 232, 88, 167, 63, 119, 7, 151, 229, 14
    ];
    assert(
        verify_ecdh(
            secret_key,
            (shared_key_x, shared_key_y),
            (public_key_x, public_key_y)
        )
    );
}

